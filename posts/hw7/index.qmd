---
title: ":LS ë¹…ë°ì´í„° ìŠ¤ì¿¨ HomeWork7"
author: "Subeen"
date: "2024-09-02"
categories: [bigdata]
jupyter: python3
---


### 1. ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¥¼ ê·¸ë ¤ë³´ì„¸ìš”.
```{python}
from scipy.stats import chi2
import matplotlib.pyplot as plt
import numpy as np
k = np.linspace(0, 20, 100)
y = chi2.pdf(k, df=7)
plt.plot(k, y, color='black')
```

### 2. ë‹¤ìŒì˜ í™•ë¥ ì„ êµ¬í•´ë³´ì„¸ìš”. ğ‘ƒ (3 â‰¤ ğ‘‹ â‰¤ 5)

```{python}
df = 4

pro = chi2.cdf(5, df) - chi2.cdf(3, df)
print(f"ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ê°€ (3 â‰¤ ğ‘‹ â‰¤ 5)ì¼ í™•ë¥ : {pro:.3f}")
```

### 3. ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ì—ì„œ í¬ê¸°ê°€ 1000ì¸ í‘œë³¸ì„ ë½‘ì€ í›„, íˆìŠ¤í† ê·¸ë¨ì„ ê·¸ë ¤ë³´ì„¸ìš”.

```{python}
from scipy.stats import chi2
import seaborn as sns
df = 4
sample = chi2.rvs(df, size=1000, random_state=2024)
sns.histplot(data=sample)

```

### 4.ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í™•ë¥ ë³€ìˆ˜ì—ì„œ ë‚˜ì˜¬ ìˆ˜ ìˆëŠ” ê°’ ì¤‘ ìƒìœ„ 5%ì— í•´ë‹¹í•˜ëŠ” ê°’ì€ ì–¼ë§ˆì¸ì§€ ê³„ì‚°í•´ë³´ì„¸ìš”.

```{python}

df = 4

value = chi2.ppf(0.95, df)

# ê²°ê³¼ ì¶œë ¥
print(f"ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ì—ì„œ ìƒìœ„ 5%ì— í•´ë‹¹í•˜ëŠ” ê°’: {value:.3f}")
```

### 5.3ë²ˆì—ì„œ ë½‘íŒ í‘œë³¸ê°’ë“¤ ì¤‘ ìƒìœ„ 5%ì— ìœ„ì¹˜í•œ í‘œë³¸ì˜ ê°’ì€ ì–¼ë§ˆì¸ê°€ìš”?

```{python}
import numpy as np
df = 4

sample = chi2.rvs(df, size=1000, random_state=2024)
percentile_value = np.percentile(sample, 95)
print(f"3ë²ˆì—ì„œ ë½‘ì€ í‘œë³¸ê°’ë“¤ ì¤‘ ìƒìœ„ 5%: {percentile_value:.3f}")
```

### 6. í‰ê· ì´ 3, í‘œì¤€í¸ì°¨ê°€ 2ì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í™•ë¥ ë³€ìˆ˜ì—ì„œ í¬ê¸°ê°€ 20ì¸ í‘œë³¸, ğ‘¥1, ..., ğ‘¥20,ì„ ë½‘ì€ í›„ í‘œë³¸ë¶„ì‚°ì„ ê³„ì‚°í•œ ê²ƒì„ ğ‘ 21 ì´ë¼ ìƒê°í•´ë³´ì£ . ë‹¤ìŒì„ ìˆ˜í–‰í•´ë³´ì„¸ìš”!
```{python}
from scipy.stats import norm
X = norm.rvs(3, 2, 20)
print(f"í‰ê· ì´3, í‘œì¤€í¸ì°¨ê°€2, í¬ê¸°ê°€ 20ì¸ í™•ë¥ ë³€ìˆ˜: {X}")
s2 = np.var(X, ddof=1)
print(f"í‘œë³¸ë¶„ì‚°:{s2:}")
```

```{python}
print("ê°™ì€ ë°©ë²•ìœ¼ë¡œ 500ê°œì˜ ğ‘ 2 ë“¤, ğ‘ 21, ğ‘ 22, ..., ğ‘ 2 500 ë°œìƒì‹œí‚µë‹ˆë‹¤.")
size = 20 
num_samples = 500  

S2_values = []

# ê° í‘œë³¸ì— ëŒ€í•´ ë¶„ì‚° ê³„ì‚°
for _ in range(num_samples):
    Y = norm.rvs(3, 2, size=size)  
    S2 = np.var(Y, ddof=1)  
    S2_values.append(S2)

# ì²« ë²ˆì§¸ í‘œë³¸ì˜ í‘œë³¸ ë¶„ì‚° ì˜ˆì‹œ ì¶œë ¥
print(f"500ê°œì˜ í‘œë³¸ë¶„ì‚° s2: {S2_values[0]:.3f}")

```

```{python}
import matplotlib.pyplot as plt

print("ë°œìƒí•œ 500ê°œì˜ ğ‘ 2 ë“¤ ê°ê°ì— 4.75ë¥¼ ê³±í•˜ê³ , ê·¸ê²ƒë“¤ì˜ íˆìŠ¤í† ê·¸ë¨ì„ ê·¸ë ¤ë³´ì„¸ìš”. (íˆìŠ¤í† ê·¸ë¨ ì„ ê·¸ë¦´ ë•Œ probability = TRUE ì˜µì…˜ì„ ì‚¬ìš©í•´ì„œ ê·¸ë¦´ ê²ƒ)")
s2value_475 = np.array(S2_values) * 4.75
sns.histplot(s2value_475, bins=30, stat="density")

print("ìœ„ì—ì„œ ê·¸ë¦° íˆìŠ¤í† ê·¸ë¨ì— ììœ ë„ê°€ 19ì¸ ì¹´ì´ì œê³±ë¶„í¬ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¥¼ ê²¹ì³ê·¸ë ¤ë³´ì„¸ìš”.")

from scipy.stats import chi2
x = np.linspace(min(s2value_475), max(s2value_475), 1000)
chi2_pdf=chi2.pdf(x,df=19)
plt.plot(x, chi2_pdf, color= 'red')

```
