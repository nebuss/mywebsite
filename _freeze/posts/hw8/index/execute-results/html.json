{
  "hash": "0eff93a042a2fe6173228363ed0c5d86",
  "result": {
    "engine": "jupyter",
    "markdown": "![](image.png)\n\n---\ntitle: \":LS ë¹…ë°ì´í„° ìŠ¤ì¿¨ HomeWork8\"\nauthor: \"Subeen\"\ndate: \"2024-09-10\"\ncategories: [bigdata]\njupyter: python3\n---\n\n::: {#611743d1 .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\n\n\ndata=  pd.read_table('C:/Users/USER/Documents/LSë¹…ë°ì´í„°ìŠ¤ì¿¨/LSbigdata-project1/data/leukemia_remission.txt', delimiter='\\t')\nprint(data.head())  # ë°ì´í„° í™•ì¸\n\n#ì¢…ì†ë³€ìˆ˜: ë°±í˜ˆë³‘ ì„¸í¬ ê´€ì¸¡ ë¶ˆê°€ ì—¬ë¶€ (REMISS), 1ì´ë©´ ê´€ì¸¡ ì•ˆë¨ì„ ì˜ë¯¸\n# ë…ë¦½ë³€ìˆ˜:\n# ê³¨ìˆ˜ì˜ ì„¸í¬ì„± (CELL)\n# ê³¨ìˆ˜í¸ì˜ ë°±í˜ˆêµ¬ ë¹„ìœ¨ (SMEAR)\n# ê³¨ìˆ˜ì˜ ë°±í˜ˆë³‘ ì„¸í¬ ì¹¨íˆ¬ ë¹„ìœ¨ (INFIL)\n# ê³¨ìˆ˜ ë°±í˜ˆë³‘ ì„¸í¬ì˜ ë¼ë²¨ë§ ì¸ë±ìŠ¤ (LI)\n# ë§ì´ˆí˜ˆì•¡ì˜ ë°±í˜ˆë³‘ ì„¸í¬ ìˆ˜ (BLAST)\n# ì¹˜ë£Œ ì‹œì‘ ì „ ìµœê³  ì²´ì˜¨ (TEMP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   REMISS  CELL  SMEAR  INFIL   LI  BLAST  TEMP\n0       1   0.8   0.83   0.66  1.9   1.10  1.00\n1       1   0.9   0.36   0.32  1.4   0.74  0.99\n2       0   0.8   0.88   0.70  0.8   0.18  0.98\n3       0   1.0   0.87   0.87  0.7   1.05  0.99\n4       1   0.9   0.75   0.68  1.3   0.52  0.98\n```\n:::\n:::\n\n\n### ë¬¸ì œ1. ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê³ , ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨ë¸ì„ ì í•©í•˜ê³ , íšŒê·€ í‘œë¥¼ ì‘ì„±í•˜ì„¸ìš”.\n\n::: {#b0c94edd .cell execution_count=2}\n``` {.python .cell-code}\nX = data[['CELL', 'SMEAR', 'INFIL', 'LI', 'BLAST', 'TEMP']]  # Independent variables\ny = data['REMISS'] \n\nX = sm.add_constant(X)\n\nlogit_model = sm.Logit(y, X)\nresult = logit_model.fit()\n\nlogit_summary = result.summary()\nlogit_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOptimization terminated successfully.\n         Current function value: 0.399886\n         Iterations 10\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<table class=\"simpletable\">\n<caption>Logit Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>        <td>REMISS</td>      <th>  No. Observations:  </th>  <td>    27</td> \n</tr>\n<tr>\n  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>    20</td> \n</tr>\n<tr>\n  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     6</td> \n</tr>\n<tr>\n  <th>Date:</th>            <td>Tue, 10 Sep 2024</td> <th>  Pseudo R-squ.:     </th>  <td>0.3718</td> \n</tr>\n<tr>\n  <th>Time:</th>                <td>10:26:27</td>     <th>  Log-Likelihood:    </th> <td> -10.797</td>\n</tr>\n<tr>\n  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -17.186</td>\n</tr>\n<tr>\n  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th>  <td>0.04670</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>const</th> <td>   64.2581</td> <td>   74.965</td> <td>    0.857</td> <td> 0.391</td> <td>  -82.670</td> <td>  211.187</td>\n</tr>\n<tr>\n  <th>CELL</th>  <td>   30.8301</td> <td>   52.135</td> <td>    0.591</td> <td> 0.554</td> <td>  -71.353</td> <td>  133.013</td>\n</tr>\n<tr>\n  <th>SMEAR</th> <td>   24.6863</td> <td>   61.526</td> <td>    0.401</td> <td> 0.688</td> <td>  -95.903</td> <td>  145.275</td>\n</tr>\n<tr>\n  <th>INFIL</th> <td>  -24.9745</td> <td>   65.281</td> <td>   -0.383</td> <td> 0.702</td> <td> -152.923</td> <td>  102.974</td>\n</tr>\n<tr>\n  <th>LI</th>    <td>    4.3605</td> <td>    2.658</td> <td>    1.641</td> <td> 0.101</td> <td>   -0.849</td> <td>    9.570</td>\n</tr>\n<tr>\n  <th>BLAST</th> <td>   -0.0115</td> <td>    2.266</td> <td>   -0.005</td> <td> 0.996</td> <td>   -4.453</td> <td>    4.430</td>\n</tr>\n<tr>\n  <th>TEMP</th>  <td> -100.1734</td> <td>   77.753</td> <td>   -1.288</td> <td> 0.198</td> <td> -252.567</td> <td>   52.220</td>\n</tr>\n</table><br/><br/>Possibly complete quasi-separation: A fraction 0.11 of observations can be<br/>perfectly predicted. This might indicate that there is complete<br/>quasi-separation. In this case some parameters will not be identified.\n```\n:::\n:::\n\n\n### ë¬¸ì œ2. í•´ë‹¹ ëª¨ë¸ì€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œê°€ìš”? ê·¸ ì´ìœ ë¥¼ ê²€ì •í†µê³„ëŸ‰ë¥¼ ì‚¬ìš©í•´ì„œ ì„¤ëª…í•˜ì‹œì˜¤.\n\n::: {#a0a9a9fb .cell execution_count=3}\n``` {.python .cell-code}\nllr_pvalue = result.llr_pvalue #ìš°ë„ë¹„ ê²€ì •ì˜ p-value : 0.04670\nll_null = result.llnull  #  ë…ë¦½ ë³€ìˆ˜ ì—†ì´ ìƒìˆ˜í•­(intercept)ë§Œì„ í¬í•¨í•œ ê·€ë¬´ëª¨í˜•ì˜ ë¡œê·¸ ìš°ë„ë°˜í™˜: -17.1858\nll_model = result.llf  # ë…ë¦½ ë³€ìˆ˜ë¥¼ í¬í•¨í•œ ëª¨ë¸ë¡œ, ë…ë¦½ ë³€ìˆ˜ë“¤ì´ ì¢…ì† ë³€ìˆ˜ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤ê³  ê°€ì •: (-10.79692\nlr_stat = 2 * (ll_model - ll_null) # LR statistic: 12.7779  í´ìˆ˜ë¡ ë…ë¦½ ë³€ìˆ˜ë¥¼ ì¶”ê°€í•œ ëª¨ë¸ì´ ì¢…ì† ë³€ìˆ˜ë¥¼ ë” ì˜ ì„¤ëª…í•œë‹¤\n\nllr_pvalue, lr_stat #  p-valueê°€ 0.05ë³´ë‹¤ ì‘ìœ¼ë¯€ë¡œ, 95% ì‹ ë¢°ìˆ˜ì¤€ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°\nfrom scipy.stats import chi2\n# âˆ’2(â„“(ğ›½)Ì‚ (0) âˆ’ â„“(ğ›½)Ì‚ )  =  -2*(-17.186+10.797)  = 12.779\n1 - chi2.cdf(12.779, df=6)  # 0.0467\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```\nnp.float64(0.0466828104726148)\n```\n:::\n:::\n\n\n### ë¬¸ì œ3. ìœ ì˜ìˆ˜ì¤€ì´ 0.2ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ë³€ìˆ˜ëŠ” ëª‡ê°œì´ë©°, ì–´ëŠ ë³€ìˆ˜ ì¸ê°€ìš”?\n\n::: {#fe4e0832 .cell execution_count=4}\n``` {.python .cell-code}\np_values = result.pvalues\np_values[p_values < 0.2]\n# 2ê°œ.  LI ,  TEMP\n```\n\n::: {.cell-output .cell-output-display execution_count=37}\n```\nLI      0.100899\nTEMP    0.197623\ndtype: float64\n```\n:::\n:::\n\n\n### ë¬¸ì œ4. ë‹¤ìŒ í™˜ìì— ëŒ€í•œ ì˜¤ì¦ˆëŠ” ì–¼ë§ˆì¸ê°€ìš”?\n\n::: {#6aa506a1 .cell execution_count=5}\n``` {.python .cell-code}\n# CELL (ê³¨ìˆ˜ì˜ ì„¸í¬ì„±): 65%\n# SMEAR (ê³¨ìˆ˜í¸ì˜ ë°±í˜ˆêµ¬ ë¹„ìœ¨): 45%\n# INFIL (ê³¨ìˆ˜ì˜ ë°±í˜ˆë³‘ ì„¸í¬ ì¹¨íˆ¬ ë¹„ìœ¨): 55%\n# LI (ê³¨ìˆ˜ ë°±í˜ˆë³‘ ì„¸í¬ì˜ ë¼ë²¨ë§ ì¸ë±ìŠ¤): 1.2\n# BLAST (ë§ì´ˆí˜ˆì•¡ì˜ ë°±í˜ˆë³‘ ì„¸í¬ ìˆ˜): 1.1ì„¸í¬/Î¼L\n# TEMP (ì¹˜ë£Œ ì‹œì‘ ì „ ìµœê³  ì²´ì˜¨): 0.9\ncoefficients = result.params\npatient_data = {\n    'const': 1,  # Intercept\n    'CELL': 0.65,  # 65%\n    'SMEAR': 0.45,  # 45%\n    'INFIL': 0.55,  # 55%\n    'LI': 1.2,  # LI value\n    'BLAST': 1.1,  # BLAST value in cells/Î¼L\n    'TEMP': 0.9  # TEMP value (already scaled)\n}\n\nlog_odds = sum(coefficients[var] * patient_data[var] for var in patient_data)\n\nodds = np.exp(log_odds)\n\nlog_odds, odds # -3.2656, 0.03817\n```\n\n::: {.cell-output .cell-output-display execution_count=38}\n```\n(np.float64(-3.265694097999827), np.float64(0.03817043186641792))\n```\n:::\n:::\n\n\n### ë¬¸ì œ 5. ìœ„ í™˜ìì˜ í˜ˆì•¡ì—ì„œ ë°±í˜ˆë³‘ ì„¸í¬ê°€ ê´€ì¸¡ë˜ì§€ ì•Šì€ í™•ë¥ ì€ ì–¼ë§ˆì¸ê°€ìš”?\n\n::: {#b1d601be .cell execution_count=6}\n``` {.python .cell-code}\nprob = 1 / (1 + np.exp(-log_odds))\nprob # 0.036767\n```\n\n::: {.cell-output .cell-output-display execution_count=39}\n```\nnp.float64(0.03676701887742584)\n```\n:::\n:::\n\n\n### ë¬¸ì œ 6. TEMP ë³€ìˆ˜ì˜ ê³„ìˆ˜ëŠ” ì–¼ë§ˆì´ë©°, í•´ë‹¹ ê³„ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ TEMP ë³€ìˆ˜ê°€ ë°±í˜ˆë³‘ ì¹˜ë£Œì— ëŒ€í•œ ì˜í–¥ì„ ì„¤ëª…í•˜ì‹œì˜¤.\n\n::: {#f60f33b9 .cell execution_count=7}\n``` {.python .cell-code}\ntemp_coef = coefficients['TEMP'] # -100.17340\n\ntemp_odds_ratio = np.exp(temp_coef)\ntemp_odds_ratio  \n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n```\nnp.float64(3.1278443426406826e-44)\n```\n:::\n:::\n\n\n 3.13e-44 - > 0ì— ê°€ê¹Œìš´ ê°’ì…ë‹ˆë‹¤. ì´ëŠ” ì²´ì˜¨ì´ 1ë‹¨ìœ„ ìƒìŠ¹í•  ë•Œ ë°±í˜ˆë³‘ ì„¸í¬ê°€ ê´€ì¸¡ë˜ì§€ ì•Šì„ í™•ë¥ ì´ (ì˜¤ì¦ˆë¹„ë§Œí¼ ë³€ë™)ê±°ì˜ ì—†ì–´ì§€ëŠ” ê²ƒì„ ì˜ë¯¸ ->  ì˜¨ë„ê°€ ë†’ì•„ì§ˆìˆ˜ë¡ ë°±í˜ˆë³‘ ì„¸í¬ê°€ ê´€ì¸¡ë  í™•ë¥  ë†’ì•„ì§.\n\n### ë¬¸ì œ 7. CELL ë³€ìˆ˜ì˜ 99% ì˜¤ì¦ˆë¹„ì— ëŒ€í•œ ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ì‹œì˜¤.\n\n::: {#284699cf .cell execution_count=8}\n``` {.python .cell-code}\ncell_coef = coefficients['CELL']\ncell_se = result.bse['CELL']  # bseëŠ” **í‘œì¤€ ì˜¤ì°¨(Standard Errors, SE)ê°€ ì €ì¥ëœ ì†ì„±\n\nz_value = 2.576 # 99% ì‹ ë¢°êµ¬ê°„ì—ì„œ zê°’\n\nlower_log_odds = cell_coef - z_value * cell_se\nupper_log_odds = cell_coef + z_value * cell_se\n\nlower_odds_ratio = np.exp(lower_log_odds)\nupper_odds_ratio = np.exp(upper_log_odds)\n\nlower_odds_ratio, upper_odds_ratio # 0ì— ê°€ê¹Œìš´ìˆ˜, ì—„ì²­ í° ìˆ˜.\n```\n\n::: {.cell-output .cell-output-display execution_count=41}\n```\n(np.float64(1.1569618556690256e-45), np.float64(5.191962380123559e+71))\n```\n:::\n:::\n\n\n### ë¬¸ì œ 8. ì£¼ì–´ì§„ ë°ì´í„°ì— ëŒ€í•˜ì—¬ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì˜ ì˜ˆì¸¡ í™•ë¥ ì„ êµ¬í•œ í›„, 50% ì´ìƒì¸ ê²½ìš° 1ë¡œ ì²˜ë¦¬í•˜ì—¬, í˜¼ë™ í–‰ë ¬ë¥¼ êµ¬í•˜ì‹œì˜¤.\n\n::: {#00000907 .cell execution_count=9}\n``` {.python .cell-code}\nfrom sklearn.metrics import confusion_matrix\npredicted_probabilities = result.predict(X)\npredicted_classes = (predicted_probabilities >= 0.5).astype(int)\nconf_matrix = confusion_matrix(y, predicted_classes)\nconf_matrix  \n\n# ì‹œê°í™”\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# í˜¼ë™í–‰ë ¬ ë°ì´í„°\nconf_matrix = [[15, 3], [4, 5]]\n\n# í˜¼ë™í–‰ë ¬ ì‹œê°í™”\nplt.figure(figsize=(6, 4))\nsns.heatmap(conf_matrix, annot=True, fmt=\"d\", cmap=\"Blues\", cbar=False)\nplt.title(\"Confusion Matrix\")\nplt.xlabel(\"Predicted Label\")\nplt.ylabel(\"True Label\")\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-10-output-1.png){width=506 height=376}\n:::\n:::\n\n\n### ë¬¸ì œ 9. í•´ë‹¹ ëª¨ë¸ì˜ AccuracyëŠ” ì–¼ë§ˆì¸ê°€ìš”?\n\n::: {#60970b81 .cell execution_count=10}\n``` {.python .cell-code}\nconf_matrix = np.array([[15, 3], [4, 5]])\n\n# ì •í™•ë„ ê³„ì‚°\naccuracy = (conf_matrix[0, 0] + conf_matrix[1, 1]) / conf_matrix.sum()\naccuracy # ì •í™•ë„: ì•½ 74.07%\n```\n\n::: {.cell-output .cell-output-display execution_count=43}\n```\nnp.float64(0.7407407407407407)\n```\n:::\n:::\n\n\n### ë¬¸ì œ 10. í•´ë‹¹ ëª¨ë¸ì˜ F1 Scoreë¥¼ êµ¬í•˜ì„¸ìš”.\n\n::: {#4bb37f56 .cell execution_count=11}\n``` {.python .cell-code}\nfrom sklearn.metrics import f1_score\n\nf1 = f1_score(y, predicted_classes)\nf1  # 0.58823\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```\nnp.float64(0.5882352941176471)\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}