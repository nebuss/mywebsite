{
  "hash": "a51ce47aecfc01ba9e82ece0506c971a",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: ':LS 빅데이터 스쿨 HomeWork5'\nauthor: Subeen\ndate: '2024-07-30'\ncategories:\n  - bigdata\n---\n\n### 챕터 9-2 설문조사 그래프에서 각 성별 95% 신뢰구간 계산후 그리기. norm.ppf() 사용해서 그릴 것. \\\n모분산은 표본 분산을 사용해서 추정\n\n::: {#6cf9bcb8 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\n\nraw_welfare = pd.read_spss('Koweps_hpwc14_2019_beta2.sav')\n\nwelfare =raw_welfare.copy()\n\nwelfare\nwelfare.shape\nwelfare.info()\nwelfare.describe()\n\nwelfare = welfare.rename(\n  columns = {'h14_g3' : 'sex',\n             'h14_g4' : 'birth',\n             'h14_g10' : 'marriage_type',\n             'h14_g11' : 'religion',\n             'p1402_8aq1' : 'income',\n             'h14_eco9' : 'code_job',\n             'h14_reg7' : 'code_region'}\n)\n\nwelfare.columns\n\n\nwelfare['sex'].dtypes\nwelfare['sex'].value_counts()\n\n# 이상치 결측처리 \nwelfare['sex'] = np.where(welfare['sex'] ==9, np.nan, welfare['sex'])\n# 결측치 확인\nwelfare['sex'].isna().sum()\n\n# 숫자1 남자. 숫자2 여자\n\nwelfare['sex'] = np.where(welfare['sex'] ==1, 'male', 'female')\n\n# 빈도 구하기\nwelfare['sex'].value_counts()\n\n# 빈도 막대그래프 그리기\nimport matplotlib.pyplot as plt\nsns.countplot(data = welfare, x = 'sex')\nplt.show()\n\n\n\nwelfare['income'].describe()\nwelfare['income'].isna().sum() \n\n\nwelfare['income'] = np.where(welfare['income'] == 9999, np.nan, welfare['income'])\nwelfare['income'].isna().sum()\n\n\nsex_income = welfare.dropna(subset = 'income') \\\n                    .groupby('sex', as_index = False) \\\n                    .agg(mean_income = ('income', 'mean'),\n                         std_income=('income', 'std'),\n                         count_income=('income', 'count'))\nsex_income  \nsns.barplot(data= sex_income, x = 'sex', y ='mean_income', hue='sex')\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 14418 entries, 0 to 14417\nColumns: 830 entries, h14_id to h14_pers_income5\ndtypes: float64(826), object(4)\nmemory usage: 91.3+ MB\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-2.png){width=601 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-3.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n# 신뢰구간 구하기\n\n::: {#e7a2e165 .cell execution_count=2}\n``` {.python .cell-code}\nimport scipy.stats as stats\n\nsex_income['ci_lower'] = sex_income['mean_income'] - 1.96 * (sex_income['std_income'] / np.sqrt(sex_income['count_income']))\n\nsex_income['ci_lower']\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n0    180.830354\n1    340.112428\nName: ci_lower, dtype: float64\n```\n:::\n:::\n\n\n::: {#f9938709 .cell execution_count=3}\n``` {.python .cell-code}\nsex_income['ci_upper'] = sex_income['mean_income'] + 1.96* (sex_income['std_income'] / np.sqrt(sex_income['count_income']))\nsex_income['ci_upper']\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\n0    191.755837\n1    357.962714\nName: ci_upper, dtype: float64\n```\n:::\n:::\n\n\n# 신뢰구간 나타낸 막대그래프 그리기\n\n::: {#7a183579 .cell execution_count=4}\n``` {.python .cell-code}\nsns.barplot(data=welfare, x='sex', y='income', errorbar=('ci', 95), hue='sex')\nplt.xlabel('Sex')\nplt.ylabel('mean_income')\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}